{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags%}

{% block metadescription %}
All Events
{% endblock %}
{% block title %}
Events | StreamStage
{% endblock title %}

{% block content %}
<div>
    <h1 class="page-title">All Events</h1>

    <!-- Listing All Events -->
    {% for event in events %}
    <div class="row my-4">
        <div class="col-9">
            <a href="{% url 'event_view' event.event_id %}">
                <div class="row">

                    <div class="col-3">
                        {% for category in event.categories.all %}
                        <span class="badge bg-primary">{{category.name}}</span>
                        {% endfor %}

                        <h4>{{ event.broadcaster.handle }}</h4>
                        {% if event.media.all.count == 0 %}
                        <img class="event-cover col-3" src="{% static 'images/default_event_cover.png' %}"
                            alt="No Event Cover Photo">
                        {% else %}
                        <img class="event-cover col-3" src="{{ cover_pic.picture.url }}">
                        {% endif %}
                    </div>
                    <div class="col-9">
                        <h4>{{ event.title }}</h4>
                        <p>{{ event.short_description }}</p>
                        <h6>Next Showing: </h6>
                        <p>{{ event.get_next_showing }}</p>
                    </div>
                </div>
            </a>
        </div>
        <!-- Reviews For Each event -->
        <div class="col-3 text-center">
            <div class="m-4">
                {% if event.get_review_count > 0 %}
                <h6>Top Review</h6>
                {% include 'reviews/review.html' with review=event.get_top_review %}
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
    <hr />
</div>
{% endblock %}